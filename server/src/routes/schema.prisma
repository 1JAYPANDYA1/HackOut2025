generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Company {
  companyId                  String     @id @default(uuid())
  companyName                String     @unique
  companyLogo                String     @unique
  companyEmail               String     @unique
  companyPhoneNumber         String?    @unique
  companyContactPersonName   String?
  companyAddress             String?    @unique

  companyDocuments           Document[] @relation("CompanyDocuments")
  projects                   Project[]  @relation("CompanyProjects")

  createdAt                  DateTime   @default(now())
  updatedAt                  DateTime   @updatedAt
}

model Document {
  documentId   String   @id @default(uuid())
  documentName String   
  documentUrl  String   @unique

  company      Company  @relation("CompanyDocuments", fields: [companyId], references: [companyId])
  companyId    String @unique

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@unique([documentName, companyId])
}

model Project {
  projectId               String      @id @default(uuid())
  projectName             String       
  requestedSubsidyAmount  Float

  company                 Company     @relation("CompanyProjects", fields: [companyId], references: [companyId])
  companyId               String 

  milestones              Milestone[]

  createdAt               DateTime    @default(now())
  updatedAt               DateTime    @updatedAt

  @@unique([projectName, companyId]) 
}

model Milestone {
  milestoneId   String   @id @default(uuid())
  milestoneName          String
  milestoneTargetDate    DateTime?
  milestoneTargetValue   String? 

  project       Project  @relation(fields: [projectId], references: [projectId])
  projectId     String

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}